name: 'OWASP Dependency-Check'
description: 'Github action to execute OWASP dependency check as part of a github workflow for NodeJS projects'
Author: '@tarsilla'
inputs:
  language:
    required: true
  build-mode:
    required: true
runs:
  using: 'composite'
  steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '22.x'
        registry-url: 'https://registry.npmjs.org'

    - name: Install dependencies
      run: npm ci

    - name: Run CodeQL Analysis
      uses: ../../base/codeql
      with:
        language: ${{ inputs.language }}
        build-mode: ${{ inputs.build-mode }}
        out: 'reports'

    - name: Upload CodeQL report
      uses: actions/upload-artifact@master
      with:
        name: CodeQL report
        path: ${{ github.workspace }}/reports
